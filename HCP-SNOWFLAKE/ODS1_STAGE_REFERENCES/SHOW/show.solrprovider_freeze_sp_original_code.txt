-- hack_spuMAPFreeze

	/*Cleanup*/
	DELETE FROM Show.SOLRProvider_Freeze WHERE SponsorCode NOT IN (SELECT ClientCode FROM Show.WebFreeze)
	DELETE Show.WebFreeze WHERE GETDATE() > FreezeEndDate

	IF OBJECT_ID('tempdb..#FreezeClientCode') IS NOT NULL DROP TABLE #FreezeClientCode
	SELECT	ClientCode 
	INTO	#FreezeClientCode
	FROM	Show.WebFreeze 
	WHERE	GETDATE() BETWEEN FreezeStartDate AND ISNULL(FreezeEndDate,'9999-09-09')

	INSERT INTO Show.SOLRProvider_Freeze(ProviderID, ProviderCode, ProviderTypeID, ProviderTypeGroup, FirstName, MiddleName, LastName, Suffix, Degree, Gender, NPI, AMAID, UPIN, MedicareID, DEANumber, TaxIDNumber, DateOfBirth, PlaceOfBirth, CarePhilosophy, ProfessionalInterest, PrimaryEmailAddress, MedicalSchoolNation, YearsSinceMedicalSchoolGraduation, HasDisplayImage, HasElectronicMedicalRecords, HasElectronicPrescription, AcceptsNewPatients, YearlySearchVolume, PatientExperienceSurveyOverallScore, PatientExperienceSurveyOverallCount, PracticeOfficeXML, FacilityXML, SpecialtyXML, EducationXML, LicenseXML, LanguageXML, MalpracticeXML, SanctionXML, SponsorshipXML, AffiliationXML, ProcedureXML, ConditionXML, HealthInsuranceXML, MediaXML, HasAddressXML, HasSpecialtyXML, Active, UpdateDate, InsertDate, ProviderLegacyKey, DisplayImage, AddressXML, BoardActionXML, SurveyXML, RecognitionXML, SurveyResponse, UpdatedDate, UpdatedSource, HasPhilosophy, HasMediaXML, HasProcedureXML, HasConditionXML, HasMalpracticeXML, HasSanctionXML, HasBoardActionXML, IsActive, ExpireCode, Title, CityStateAll, SurveyResponseDate, ProviderSpecialtyFacility5StarXML, HasProviderSpecialtyFacility5StarXML, DisplayPatientExperienceSurveyOverallScore, ProductGroupCode, SponsorCode, FacilityCode, SearchSponsorshipXML, ProductCode, VideoXML, OASXML, SuppressSurvey, ProviderURL, ImageXML, AdXML, HasProfessionalOrganizationXML, ProfessionalOrganizationXML, ProviderProfileViewOneYear, PracticingSpecialtyXML, CertificationXML, HasPracticingSpecialtyXML, HasCertificationXML, PatientExperienceSurveyOverallStarValue, ProviderBiography, DisplayStatusCode, HealthInsuranceXML_v2, ProviderDEAXML, ProviderTypeXML, SubStatusCode, DuplicateProviderCode, DeactivationReason, ProcedureHierarchyXML, ConditionHierarchyXML, ProcMappedXML, CondMappedXML, PracSpecHeirXML, AboutMeXML, HasAboutMeXML, PatientVolume, HasMalpracticeState, ProcedureCount, ConditionCount, AvailabilityXML, VideoXML2, AvailabilityStatement, IsInClientMarket, HasOAR, IsMMPUser, NatlAdvertisingXML, APIXML, DIHGroupNumber, SubStatusDescription, DEAXML, EmailAddressXML, DegreeXML, HasSurveyXML, HasDEAXML, HasEmailAddressXML, ClientCertificationXML, HasGoogleOAS, HasVideoXML2, HasAboutMe, ConversionPathXML, SearchBoostSatisfaction, SearchBoostAccessibility, IsPCPCalculated, FAFBoostSatisfaction, FAFBoostSancMalp, FFDisplaySpecialty, FFPESBoost, FFMalMultiHQ, FFMalMulti, CLinicalFocusXML, ClinicalFocusDCPXML, SyndicationXML, TeleHealthXML)
	SELECT	ProviderID, ProviderCode, ProviderTypeID, ProviderTypeGroup, FirstName, MiddleName, LastName, Suffix, Degree, Gender, NPI, AMAID, UPIN, MedicareID, DEANumber, TaxIDNumber, DateOfBirth, PlaceOfBirth, CarePhilosophy, ProfessionalInterest, PrimaryEmailAddress, MedicalSchoolNation, YearsSinceMedicalSchoolGraduation, HasDisplayImage, HasElectronicMedicalRecords, HasElectronicPrescription, AcceptsNewPatients, YearlySearchVolume, PatientExperienceSurveyOverallScore, PatientExperienceSurveyOverallCount, PracticeOfficeXML, FacilityXML, SpecialtyXML, EducationXML, LicenseXML, LanguageXML, MalpracticeXML, SanctionXML, SponsorshipXML, AffiliationXML, ProcedureXML, ConditionXML, HealthInsuranceXML, MediaXML, HasAddressXML, HasSpecialtyXML, Active, UpdateDate, InsertDate, ProviderLegacyKey, DisplayImage, AddressXML, BoardActionXML, SurveyXML, RecognitionXML, SurveyResponse, UpdatedDate, UpdatedSource, HasPhilosophy, HasMediaXML, HasProcedureXML, HasConditionXML, HasMalpracticeXML, HasSanctionXML, HasBoardActionXML, IsActive, ExpireCode, Title, CityStateAll, SurveyResponseDate, ProviderSpecialtyFacility5StarXML, HasProviderSpecialtyFacility5StarXML, DisplayPatientExperienceSurveyOverallScore, ProductGroupCode, SponsorCode, FacilityCode, SearchSponsorshipXML, ProductCode, VideoXML, OASXML, SuppressSurvey, ProviderURL, ImageXML, AdXML, HasProfessionalOrganizationXML, ProfessionalOrganizationXML, ProviderProfileViewOneYear, PracticingSpecialtyXML, CertificationXML, HasPracticingSpecialtyXML, HasCertificationXML, PatientExperienceSurveyOverallStarValue, ProviderBiography, DisplayStatusCode, HealthInsuranceXML_v2, ProviderDEAXML, ProviderTypeXML, SubStatusCode, DuplicateProviderCode, DeactivationReason, ProcedureHierarchyXML, ConditionHierarchyXML, ProcMappedXML, CondMappedXML, PracSpecHeirXML, AboutMeXML, HasAboutMeXML, PatientVolume, HasMalpracticeState, ProcedureCount, ConditionCount, AvailabilityXML, VideoXML2, AvailabilityStatement, IsInClientMarket, HasOAR, IsMMPUser, NatlAdvertisingXML, APIXML, DIHGroupNumber, SubStatusDescription, DEAXML, EmailAddressXML, DegreeXML, HasSurveyXML, HasDEAXML, HasEmailAddressXML, ClientCertificationXML, HasGoogleOAS, HasVideoXML2, HasAboutMe, ConversionPathXML, SearchBoostSatisfaction, SearchBoostAccessibility, IsPCPCalculated, FAFBoostSatisfaction, FAFBoostSancMalp, FFDisplaySpecialty, FFPESBoost, FFMalMultiHQ, FFMalMulti, CLinicalFocusXML, ClinicalFocusDCPXML, SyndicationXML, TeleHealthXML
	FROM	Show.SOLRProvider
	WHERE	SponsorCode IN (SELECT ClientCode FROM #FreezeClientCode)
			AND SponsorCode NOT IN (SELECT DISTINCT SponsorCode FROM Show.SOLRProvider_Freeze)
